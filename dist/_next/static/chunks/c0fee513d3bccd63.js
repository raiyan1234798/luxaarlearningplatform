(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3116,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 6v6l4 2",key:"mmk7yg"}]]);e.s(["Clock",()=>t],3116)},73884,e=>{"use strict";let t=(0,e.i(75254).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],73884)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},87130,e=>{"use strict";let t=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>t],87130)},65836,e=>{"use strict";var t=e.i(18050),r=e.i(90571),a=e.i(71645),i=e.i(46932),s=e.i(5766);e.i(36180);var l=e.i(98925),o=e.i(67426),n=e.i(75157),d=e.i(69638),c=e.i(73884),p=e.i(55436),u=e.i(61911),x=e.i(3116),y=e.i(87130);function g({users:e}){let[r,g]=(0,a.useState)(e),[h,f]=(0,a.useState)(""),[m,v]=(0,a.useState)("all"),[j,b]=(0,a.useState)(null),S=r.filter(e=>{let t=(e.email||"").toLowerCase().includes(h.toLowerCase())||(e.full_name||"").toLowerCase().includes(h.toLowerCase()),r="all"===m||e.status===m;return t&&r}),k=r.filter(e=>"pending"===e.status).length,z=r.filter(e=>"approved"===e.status).length;async function C(e,t){b(e);try{let r=(0,l.doc)(o.db,"users",e);await (0,l.updateDoc)(r,{status:t,updated_at:new Date().toISOString()}),s.default.success(`User ${t}`),g(r=>r.map(r=>r.id===e?{...r,status:t}:r))}catch(e){console.error("Error updating user status:",e),s.default.error("Failed to update user")}b(null)}async function w(e,t){b(e);try{let r=(0,l.doc)(o.db,"users",e);await (0,l.updateDoc)(r,{role:t,updated_at:new Date().toISOString()}),s.default.success(`Role updated to ${t}`),g(r=>r.map(r=>r.id===e?{...r,role:t}:r))}catch(e){console.error("Error updating user role:",e),s.default.error("Failed to update role")}b(null)}return(0,t.jsxs)("div",{style:{maxWidth:1100},children:[(0,t.jsxs)(i.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},style:{marginBottom:28},children:[(0,t.jsx)("h1",{style:{fontFamily:"Poppins, sans-serif",fontSize:"clamp(1.5rem, 3vw, 2rem)",fontWeight:700,color:"var(--text-primary)",letterSpacing:"-0.02em",marginBottom:4},children:"Manage Users"}),(0,t.jsx)("p",{style:{color:"var(--text-secondary)",fontSize:14},children:"Approve or reject access requests and manage user roles."})]}),(0,t.jsx)("div",{style:{display:"flex",gap:14,marginBottom:24,flexWrap:"wrap"},children:[{label:"Total",value:r.length,icon:u.Users,color:"#c9a84c"},{label:"Pending",value:k,icon:x.Clock,color:"#f59e0b"},{label:"Approved",value:z,icon:d.CheckCircle,color:"#4ade80"}].map((e,r)=>(0,t.jsxs)(i.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.07*r},className:"card",style:{padding:"14px 18px",display:"flex",alignItems:"center",gap:12,flex:"1 1 calc(33% - 14px)",minWidth:140},children:[(0,t.jsx)("div",{style:{width:34,height:34,borderRadius:9,background:`${e.color}14`,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsx)(e.icon,{size:16,color:e.color})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontSize:20,fontWeight:800,fontFamily:"Poppins",color:"var(--text-primary)"},children:e.value}),(0,t.jsx)("div",{style:{fontSize:12,color:"var(--text-muted)"},children:e.label})]})]},e.label))}),(0,t.jsxs)(i.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},style:{display:"flex",gap:12,marginBottom:20,flexWrap:"wrap",alignItems:"center"},children:[(0,t.jsxs)("div",{style:{position:"relative",flex:"1 1 240px",maxWidth:360},children:[(0,t.jsx)(p.Search,{size:15,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),(0,t.jsx)("input",{className:"input",type:"text",placeholder:"Search users...",value:h,onChange:e=>f(e.target.value),style:{paddingLeft:36}})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[(0,t.jsx)(y.Filter,{size:13,color:"var(--text-muted)"}),["all","pending","approved","rejected"].map(e=>(0,t.jsx)("button",{onClick:()=>v(e),style:{padding:"6px 12px",borderRadius:7,border:"1px solid",borderColor:m===e?"rgba(201,168,76,0.5)":"var(--border)",background:m===e?"rgba(201,168,76,0.1)":"transparent",color:m===e?"#c9a84c":"var(--text-secondary)",fontSize:12,fontWeight:m===e?600:400,cursor:"pointer",textTransform:"capitalize"},children:e},e))]})]}),(0,t.jsx)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},className:"card",style:{overflow:"hidden"},children:0===S.length?(0,t.jsxs)("div",{style:{padding:40,textAlign:"center"},children:[(0,t.jsx)(u.Users,{size:40,color:"var(--text-muted)",style:{marginBottom:12,opacity:.4}}),(0,t.jsx)("p",{style:{color:"var(--text-muted)",fontSize:14},children:"No users found"})]}):(0,t.jsx)("div",{style:{overflowX:"auto"},children:(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{style:{borderBottom:"1px solid var(--border)"},children:["User","Status","Role","Joined","Actions"].map(e=>(0,t.jsx)("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em"},children:e},e))})}),(0,t.jsx)("tbody",{children:S.map((e,r)=>(0,t.jsxs)(i.motion.tr,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.03*r},style:{borderBottom:"1px solid var(--border)",transition:"background 0.15s"},onMouseEnter:e=>e.currentTarget.style.background="var(--bg-secondary)",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,t.jsx)("td",{style:{padding:"12px 16px"},children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,t.jsx)("div",{style:{width:34,height:34,borderRadius:"50%",background:"linear-gradient(135deg, #c9a84c, #a07830)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,color:"#0a0a0a",flexShrink:0},children:(0,n.getInitials)(e.full_name)}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontSize:14,fontWeight:500,color:"var(--text-primary)"},children:e.full_name||"â€”"}),(0,t.jsx)("div",{style:{fontSize:12,color:"var(--text-muted)"},children:e.email})]})]})}),(0,t.jsx)("td",{style:{padding:"12px 16px"},children:(0,t.jsxs)("span",{style:{fontSize:12,padding:"3px 10px",borderRadius:999,fontWeight:500,background:"approved"===e.status?"rgba(74,222,128,0.1)":"pending"===e.status?"rgba(201,168,76,0.1)":"rgba(248,113,113,0.1)",color:"approved"===e.status?"#4ade80":"pending"===e.status?"#c9a84c":"#f87171",display:"flex",alignItems:"center",gap:4,width:"fit-content"},children:[(0,t.jsx)("span",{className:"status-dot",style:{width:6,height:6,background:"currentColor",borderRadius:"50%",display:"inline-block"}}),e.status]})}),(0,t.jsx)("td",{style:{padding:"12px 16px"},children:(0,t.jsxs)("select",{value:e.role,onChange:t=>w(e.id,t.target.value),disabled:j===e.id,className:"input",style:{width:"auto",padding:"5px 10px",fontSize:12},children:[(0,t.jsx)("option",{value:"student",children:"Student"}),(0,t.jsx)("option",{value:"admin",children:"Admin"})]})}),(0,t.jsx)("td",{style:{padding:"12px 16px",fontSize:13,color:"var(--text-muted)"},children:(0,n.formatDate)(e.created_at)}),(0,t.jsx)("td",{style:{padding:"12px 16px"},children:(0,t.jsxs)("div",{style:{display:"flex",gap:6},children:["approved"!==e.status&&(0,t.jsxs)("button",{onClick:()=>C(e.id,"approved"),disabled:j===e.id,style:{display:"flex",alignItems:"center",gap:5,padding:"6px 12px",borderRadius:7,border:"1px solid rgba(74,222,128,0.3)",background:"rgba(74,222,128,0.08)",color:"#4ade80",fontSize:12,fontWeight:500,cursor:"pointer"},children:[(0,t.jsx)(d.CheckCircle,{size:13}),"Approve"]}),"rejected"!==e.status&&(0,t.jsxs)("button",{onClick:()=>C(e.id,"rejected"),disabled:j===e.id,style:{display:"flex",alignItems:"center",gap:5,padding:"6px 12px",borderRadius:7,border:"1px solid rgba(248,113,113,0.3)",background:"rgba(248,113,113,0.08)",color:"#f87171",fontSize:12,fontWeight:500,cursor:"pointer"},children:[(0,t.jsx)(c.XCircle,{size:13}),"Reject"]})]})})]},e.id))})]})})})]})}var h=e.i(18566),f=e.i(21841);function m(){let{user:e,profile:i,loading:s}=(0,r.useAuth)(),n=(0,h.useRouter)(),[d,c]=(0,a.useState)([]),[p,u]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{!s&&i&&"admin"!==i.role&&n.push("/dashboard")},[s,i,n]),(0,a.useEffect)(()=>{async function t(){try{let e=(0,l.collection)(o.db,"users"),t=(0,l.query)(e,(0,l.orderBy)("created_at","desc")),r=await (0,l.getDocs)(t),a=[];r.forEach(e=>{a.push(e.data())}),c(a)}catch(e){console.error("Error fetching users:",e)}finally{u(!1)}}e&&i?.role==="admin"&&t()},[e,i]),e&&i&&"admin"===i.role)?p?(0,t.jsx)(f.default,{text:"Loading users..."}):(0,t.jsx)(g,{users:d}):null}e.s(["default",()=>m],65836)}]);