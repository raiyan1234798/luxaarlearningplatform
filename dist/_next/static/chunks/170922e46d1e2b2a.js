(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3116,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 6v6l4 2",key:"mmk7yg"}]]);e.s(["Clock",()=>t],3116)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},63488,e=>{"use strict";let t=(0,e.i(75254).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);e.s(["Mail",()=>t],63488)},84614,e=>{"use strict";let t=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>t],84614)},63723,e=>{"use strict";var t=e.i(18050),s=e.i(90571),a=e.i(18566),i=e.i(71645),r=e.i(21841),l=e.i(46932);e.i(36180);var o=e.i(98925),d=e.i(67426),n=e.i(69638),c=e.i(3116),y=e.i(63488),u=e.i(86311),p=e.i(27612),m=e.i(84614),g=e.i(5766);function x(){let[e,s]=(0,i.useState)([]),[a,r]=(0,i.useState)(!0),[x,h]=(0,i.useState)("all");async function f(){r(!0);try{let e=(0,o.query)((0,o.collection)(d.db,"support_messages"),(0,o.orderBy)("created_at","desc")),t=await (0,o.getDocs)(e),a=[];t.forEach(e=>{a.push({id:e.id,...e.data()})}),s(a)}catch(e){console.error("Error fetching messages:",e),g.default.error("Failed to load messages")}finally{r(!1)}}async function v(e){try{await (0,o.updateDoc)((0,o.doc)(d.db,"support_messages",e),{status:"resolved"}),s(t=>t.map(t=>t.id===e?{...t,status:"resolved"}:t)),g.default.success("Marked as resolved")}catch(e){console.error("Error updating message:",e),g.default.error("Failed to update message")}}async function j(e){if(confirm("Are you sure you want to delete this message?"))try{await (0,o.deleteDoc)((0,o.doc)(d.db,"support_messages",e)),s(t=>t.filter(t=>t.id!==e)),g.default.success("Message deleted")}catch(e){console.error("Error deleting message:",e),g.default.error("Failed to delete message")}}(0,i.useEffect)(()=>{f()},[]);let b=e.filter(e=>"all"===x||e.status===x);return a?(0,t.jsx)("div",{className:"p-8 text-center",children:"Loading messages..."}):(0,t.jsxs)("div",{style:{maxWidth:1e3},children:[(0,t.jsxs)(l.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},style:{marginBottom:28},children:[(0,t.jsx)("h1",{style:{fontFamily:"Poppins, sans-serif",fontSize:"clamp(1.5rem, 3vw, 2rem)",fontWeight:700,color:"var(--text-primary)",marginBottom:8},children:"Support Messages"}),(0,t.jsx)("p",{style:{color:"var(--text-secondary)"},children:"View and manage inquiries from students."})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:24},children:[(0,t.jsx)("button",{className:"all"===x?"btn-primary":"btn-secondary",onClick:()=>h("all"),style:{fontSize:13,padding:"6px 16px"},children:"All Messages"}),(0,t.jsxs)("button",{className:"new"===x?"btn-primary":"btn-secondary",onClick:()=>h("new"),style:{fontSize:13,padding:"6px 16px"},children:["Found New (",e.filter(e=>"new"===e.status).length,")"]}),(0,t.jsx)("button",{className:"resolved"===x?"btn-primary":"btn-secondary",onClick:()=>h("resolved"),style:{fontSize:13,padding:"6px 16px"},children:"Resolved"})]}),(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:0===b.length?(0,t.jsxs)("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:[(0,t.jsx)(u.MessageSquare,{size:48,style:{opacity:.2,marginBottom:16}}),(0,t.jsx)("p",{children:"No messages found matching your filter."})]}):b.map((e,s)=>(0,t.jsxs)(l.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*s},className:"card",style:{padding:20,borderLeft:"new"===e.status?"4px solid #c9a84c":"4px solid var(--border)",opacity:"resolved"===e.status?.8:1},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[(0,t.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,t.jsx)("div",{style:{width:40,height:40,borderRadius:"50%",background:"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsx)(m.User,{size:20,color:"var(--text-secondary)"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:e.user_name}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,color:"var(--text-muted)"},children:[(0,t.jsx)(y.Mail,{size:12}),e.user_email]})]})]}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:6},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,color:"var(--text-muted)"},children:[(0,t.jsx)(c.Clock,{size:12}),new Date(e.created_at).toLocaleString()]}),"new"===e.status&&(0,t.jsx)("span",{style:{fontSize:10,fontWeight:600,background:"rgba(201,168,76,0.15)",color:"#c9a84c",padding:"2px 8px",borderRadius:999},children:"NEW"})]})]}),(0,t.jsx)("div",{style:{background:"var(--bg-secondary)",padding:16,borderRadius:8,fontSize:14,lineHeight:1.6,color:"var(--text-primary)",marginBottom:16,whiteSpace:"pre-wrap"},children:e.message}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:12},children:[(0,t.jsxs)("button",{onClick:()=>j(e.id),className:"btn-secondary",style:{fontSize:12,color:"#ef4444",borderColor:"rgba(239,68,68,0.2)"},children:[(0,t.jsx)(p.Trash2,{size:14,style:{marginRight:6}}),"Delete"]}),"new"===e.status&&(0,t.jsxs)("button",{onClick:()=>v(e.id),className:"btn-primary",style:{fontSize:12},children:[(0,t.jsx)(n.CheckCircle,{size:14,style:{marginRight:6}}),"Mark as Resolved"]})]})]},e.id))})]})}function h(){let{user:e,profile:l,loading:o}=(0,s.useAuth)(),d=(0,a.useRouter)();return((0,i.useEffect)(()=>{o||e&&l?.role==="admin"||d.push("/dashboard")},[e,l,o,d]),o||!l||"admin"!==l.role)?(0,t.jsx)(r.default,{}):(0,t.jsx)(x,{})}e.s(["default",()=>h],63723)}]);