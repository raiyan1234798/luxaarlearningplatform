(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3116,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 6v6l4 2",key:"mmk7yg"}]]);e.s(["Clock",()=>t],3116)},31343,e=>{"use strict";let t=(0,e.i(75254).default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);e.s(["Play",()=>t],31343)},70756,e=>{"use strict";let t=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],70756)},64659,55900,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>s],64659);let i=(0,t.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);e.s(["ChevronUp",()=>i],55900)},88511,e=>{"use strict";let t=(0,e.i(75254).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>t],88511)},22708,e=>{"use strict";var t=e.i(18050),s=e.i(18566),i=e.i(90571),r=e.i(71645),n=e.i(46932),l=e.i(5766);e.i(36180);var a=e.i(98925),o=e.i(67426),d=e.i(75157),c=e.i(10980),u=e.i(31343),x=e.i(3116),m=e.i(61911),p=e.i(69638),h=e.i(64659),y=e.i(55900),g=e.i(70756),f=e.i(88511),j=e.i(14764);let v=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var b=e.i(22016);function z({course:e,enrollment:z,userId:S,isAdmin:_}){(0,s.useRouter)();let{profile:w}=(0,i.useAuth)(),[k,C]=(0,r.useState)(!1),[B,A]=(0,r.useState)(""),[q,D]=(0,r.useState)(null),[N,R]=(0,r.useState)(!0),[I,W]=(0,r.useState)(new Set([e.modules?.[0]?.id])),P=e.modules?.reduce((e,t)=>e+(t.lessons?.length??0),0)??0,T=(0,d.getDifficultyColor)(e.difficulty);async function E(){C(!0);try{await (0,a.addDoc)((0,a.collection)(o.db,"course_access_requests"),{user_id:S,user_name:w?.full_name||"Unknown",user_email:w?.email||"",course_id:e.id,course_title:e.title,status:"pending",message:B.trim()||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),l.default.success("Access request submitted! The admin will review it."),D("pending")}catch(e){console.error("Error submitting request:",e),l.default.error("Failed to submit request")}C(!1)}return(0,r.useEffect)(()=>{!async function(){if(_||z)return R(!1);try{let t=(0,a.query)((0,a.collection)(o.db,"course_access_requests"),(0,a.where)("user_id","==",S),(0,a.where)("course_id","==",e.id)),s=await (0,a.getDocs)(t);if(!s.empty){let e=s.docs[0].data();D(e.status)}}catch(e){}finally{R(!1)}}()},[S,e.id,_,z]),(0,t.jsxs)("div",{style:{maxWidth:1100},children:[(0,t.jsxs)(n.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},style:{marginBottom:32},children:[(0,t.jsxs)("div",{style:{display:"flex",gap:10,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[(0,t.jsx)("span",{className:`badge ${T}`,style:{fontSize:12},children:e.difficulty}),e.tags?.map(e=>(0,t.jsx)("span",{style:{fontSize:12,padding:"3px 10px",borderRadius:999,background:"var(--bg-secondary)",color:"var(--text-muted)"},children:e},e)),!e.is_published&&(0,t.jsx)("span",{style:{fontSize:12,padding:"3px 10px",borderRadius:999,background:"rgba(248,113,113,0.1)",color:"#f87171"},children:"Draft"})]}),(0,t.jsx)("h1",{style:{fontFamily:"Poppins, sans-serif",fontSize:"clamp(1.5rem, 3vw, 2.25rem)",fontWeight:700,color:"var(--text-primary)",letterSpacing:"-0.02em",marginBottom:12,lineHeight:1.2},children:e.title}),(0,t.jsx)("p",{style:{color:"var(--text-secondary)",fontSize:15,lineHeight:1.7,marginBottom:16,maxWidth:700},children:e.description}),(0,t.jsxs)("div",{style:{display:"flex",gap:20,flexWrap:"wrap",alignItems:"center",fontSize:14,color:"var(--text-muted)"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,t.jsx)(m.Users,{size:14,color:"#c9a84c"}),(0,t.jsx)("span",{style:{color:"var(--text-secondary)"},children:e.instructor_name})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,t.jsx)(c.BookOpen,{size:14}),(0,t.jsxs)("span",{children:[P," lessons"]})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,t.jsx)(x.Clock,{size:14}),(0,t.jsxs)("span",{children:["Updated ",(0,d.formatDate)(e.updated_at)]})]})]})]}),(0,t.jsxs)("div",{className:"course-detail-grid",children:[(0,t.jsxs)(n.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},children:[(0,t.jsx)("h2",{style:{fontSize:17,fontWeight:600,color:"var(--text-primary)",marginBottom:14},children:"Course Content"}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[e.modules?.sort((e,t)=>e.order_index-t.order_index).map((e,s)=>(0,t.jsxs)("div",{className:"card",style:{overflow:"hidden"},children:[(0,t.jsxs)("button",{onClick:()=>{var t;return t=e.id,void W(e=>{let s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s})},style:{width:"100%",padding:"16px 18px",background:"none",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:12,textAlign:"left"},children:[(0,t.jsx)("div",{style:{width:30,height:30,borderRadius:8,background:"rgba(201,168,76,0.1)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,fontSize:13,fontWeight:700,color:"#c9a84c"},children:s+1}),(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsx)("div",{style:{fontWeight:600,fontSize:14,color:"var(--text-primary)"},children:e.title}),(0,t.jsxs)("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[e.lessons?.length??0," lessons"]})]}),I.has(e.id)?(0,t.jsx)(y.ChevronUp,{size:16,color:"var(--text-muted)"}):(0,t.jsx)(h.ChevronDown,{size:16,color:"var(--text-muted)"})]}),I.has(e.id)&&e.lessons&&(0,t.jsx)("div",{style:{borderTop:"1px solid var(--border)",padding:"8px"},children:e.lessons.sort((e,t)=>(e.order_index??0)-(t.order_index??0)).map((e,s)=>(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"10px 10px",borderRadius:8},children:[z||_?(0,t.jsx)(u.Play,{size:14,color:"#c9a84c"}):(0,t.jsx)(g.Lock,{size:14,color:"var(--text-muted)"}),(0,t.jsxs)("span",{style:{fontSize:13,color:z||_?"var(--text-primary)":"var(--text-muted)",flex:1},children:[s+1,". ",e.title]})]},e.id))})]},e.id)),(!e.modules||0===e.modules.length)&&(0,t.jsxs)("div",{className:"card",style:{padding:32,textAlign:"center"},children:[(0,t.jsx)(c.BookOpen,{size:32,color:"var(--text-muted)",style:{marginBottom:12}}),(0,t.jsx)("p",{style:{color:"var(--text-muted)",fontSize:14},children:"No content added yet."})]})]})]}),(0,t.jsx)(n.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"course-detail-sidebar",children:(0,t.jsxs)("div",{className:"card",style:{padding:"24px"},children:[z?(0,t.jsxs)("div",{style:{textAlign:"center"},children:[(0,t.jsx)("div",{style:{width:48,height:48,borderRadius:"50%",background:"rgba(74,222,128,0.1)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 12px"},children:(0,t.jsx)(p.CheckCircle,{size:24,color:"#4ade80"})}),(0,t.jsx)("p",{style:{fontSize:14,fontWeight:600,marginBottom:6,color:"var(--text-primary)"},children:"You're enrolled"}),(0,t.jsx)("div",{className:"progress-bar",style:{marginBottom:8},children:(0,t.jsx)("div",{className:"progress-fill",style:{width:`${z.progress_percentage}%`}})}),(0,t.jsxs)("p",{style:{fontSize:12,color:"#c9a84c",marginBottom:16},children:[z.progress_percentage,"% complete"]}),(0,t.jsx)(b.default,{href:`/dashboard/courses/learn?id=${e.id}`,children:(0,t.jsxs)("button",{className:"btn-primary",style:{width:"100%",justifyContent:"center"},children:[(0,t.jsx)(u.Play,{size:16}),z.progress_percentage>0?"Continue":"Start Learning"]})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{style:{marginBottom:16},children:[(0,t.jsx)("p",{style:{fontSize:22,fontWeight:800,color:"var(--text-primary)",marginBottom:4},children:"Free"}),(0,t.jsx)("p",{style:{fontSize:13,color:"var(--text-muted)"},children:"Full course access"})]}),(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:10,marginBottom:20},children:[`${P} lessons`,`${e.modules?.length??0} modules`,"Lifetime access","Completion certificate"].map(e=>(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,t.jsx)(p.CheckCircle,{size:14,color:"#4ade80"}),(0,t.jsx)("span",{style:{fontSize:13,color:"var(--text-secondary)"},children:e})]},e))}),N?(0,t.jsx)("div",{style:{textAlign:"center",padding:"12px 0"},children:(0,t.jsx)(v,{size:20,color:"#c9a84c",style:{animation:"spin 1s linear infinite"}})}):"pending"===q?(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsxs)("div",{style:{padding:"12px 16px",borderRadius:10,background:"rgba(201,168,76,0.08)",border:"1px solid rgba(201,168,76,0.2)",marginBottom:8},children:[(0,t.jsx)(x.Clock,{size:18,color:"#c9a84c",style:{marginBottom:6}}),(0,t.jsx)("p",{style:{fontSize:13,fontWeight:600,color:"#c9a84c",marginBottom:2},children:"Request Pending"}),(0,t.jsx)("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"Your access request is being reviewed by the admin."})]})}):"approved"===q?(0,t.jsxs)("div",{style:{textAlign:"center"},children:[(0,t.jsxs)("div",{style:{padding:"12px 16px",borderRadius:10,background:"rgba(74,222,128,0.08)",border:"1px solid rgba(74,222,128,0.2)",marginBottom:8},children:[(0,t.jsx)(p.CheckCircle,{size:18,color:"#4ade80",style:{marginBottom:6}}),(0,t.jsx)("p",{style:{fontSize:13,fontWeight:600,color:"#4ade80",marginBottom:2},children:"Access Approved!"}),(0,t.jsx)("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"You now have access to this course."})]}),(0,t.jsx)(b.default,{href:`/dashboard/courses/learn?id=${e.id}`,children:(0,t.jsxs)("button",{className:"btn-primary",style:{width:"100%",justifyContent:"center",marginTop:8},children:[(0,t.jsx)(u.Play,{size:16}),"Start Learning"]})})]}):"rejected"===q?(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsxs)("div",{style:{padding:"12px 16px",borderRadius:10,background:"rgba(248,113,113,0.08)",border:"1px solid rgba(248,113,113,0.2)"},children:[(0,t.jsx)("p",{style:{fontSize:13,fontWeight:600,color:"#f87171",marginBottom:2},children:"Request Rejected"}),(0,t.jsx)("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"Your access request was not approved. Contact the admin for more details."})]})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("textarea",{className:"input",placeholder:"Add a message (optional)...",value:B,onChange:e=>A(e.target.value),rows:3,style:{resize:"vertical",marginBottom:10,fontSize:13,minHeight:60}}),(0,t.jsx)("button",{className:"btn-primary",onClick:E,disabled:k,style:{width:"100%",justifyContent:"center"},children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v,{size:16,style:{animation:"spin 1s linear infinite"}}),"Submitting..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.Send,{size:16}),"Request Access"]})})]})]}),_&&(0,t.jsx)("div",{style:{marginTop:14,paddingTop:14,borderTop:"1px solid var(--border)"},children:(0,t.jsx)(b.default,{href:`/dashboard/admin/courses/edit?id=${e.id}`,children:(0,t.jsxs)("button",{className:"btn-secondary",style:{width:"100%",justifyContent:"center",fontSize:13},children:[(0,t.jsx)(f.Edit,{size:14}),"Edit Course"]})})})]})})]})]})}var S=e.i(21841);function _({params:e}){let{courseId:n}=(0,r.use)(e),{user:l,profile:d}=(0,i.useAuth)(),[c,u]=(0,r.useState)(null),[x,m]=(0,r.useState)(!0),[p,h]=(0,r.useState)(null),[y,g]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{async function e(){if(!l)return void m(!1);try{let e=(0,a.collection)(o.db,"enrollments"),t=(0,a.query)(e,(0,a.where)("user_id","==",l.uid),(0,a.where)("course_id","==",n)),s=await (0,a.getDocs)(t);if(!s.empty){let e=s.docs[0].data();u({id:s.docs[0].id,user_id:e.user_id,course_id:e.course_id,enrolled_at:e.enrolled_at,completed_at:e.completed_at,progress_percentage:e.progress_percentage||0,certificate_issued:e.certificate_issued||!1})}}catch(e){console.error("Error checking enrollment:",e)}m(!1)}async function t(){g(!0);try{let e=(0,a.doc)(o.db,"courses",n),t=await (0,a.getDoc)(e);if(t.exists()){let e=t.data(),s=(0,a.query)((0,a.collection)(o.db,"modules"),(0,a.where)("course_id","==",n)),i=(await (0,a.getDocs)(s)).docs.map(e=>({id:e.id,...e.data(),lessons:[]})),r=(0,a.query)((0,a.collection)(o.db,"lessons"),(0,a.where)("course_id","==",n)),l=(await (0,a.getDocs)(r)).docs.map(e=>({id:e.id,...e.data()}));i.forEach(e=>{e.lessons=l.filter(t=>t.module_id===e.id).sort((e,t)=>(e.order_index||0)-(t.order_index||0))}),i.sort((e,t)=>(e.order_index||0)-(t.order_index||0)),h({...e,id:t.id,modules:i})}}catch(e){console.error("Error fetching course:",e)}finally{g(!1)}}l?e():m(!1),t()},[l,n]),d||l)?x||y?(0,t.jsx)(S.default,{text:"Loading course...",size:"sm"}):(p||(0,s.notFound)(),(0,t.jsx)(z,{course:p,enrollment:c,userId:l?l.uid:"",isAdmin:d?.role==="admin"})):(0,t.jsx)(S.default,{text:"Loading...",size:"sm"})}function w(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)(S.default,{}),children:(0,t.jsx)(k,{})})}function k(){let e=(0,s.useSearchParams)().get("id");if(!e)return(0,t.jsx)("div",{className:"p-8",children:"No course ID provided"});let i=Promise.resolve({courseId:e});return(0,t.jsx)(_,{params:i})}e.s(["default",()=>w],22708)}]);